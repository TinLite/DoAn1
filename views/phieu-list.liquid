{% layout "_include/layout.liquid" %}
{% block content %}
    <div class="container mx-auto p-4 max-w-2xl">
        <div class="flex justify-between pt-2 border-b-2 border-gray-900 border-solid items-center">
            <div class="text-xl">Thông tin phiếu</div>
            <a class="px-4 py-2 bg-lime-700 text-white" href="{{ req.baseUrl }}/generate">Tạo phiếu mới</a>
        </div>
        <div>
            <div id="search-container">
                <form
                    action=""
                    method="get"
                    class="flex">
                    <input
                        type="search"
                        id="search-input"
                        class="flex-auto"
                        placeholder="Tìm kiếm phiếu xe">
                    <select
                        name=""
                        id=""
                        class="">
                        <option value="">Mã phiếu</option>
                        <option value="">Mã bãi</option>
                    </select>
                    <button type="submit" class="bg-black text-white py-2 px-4 ">Tìm kiếm</button>
                </form>
            </div>
        </div>
        <table class="border-collapse border w-full text-center">
            <thead class="bg-gray-100 border-b border-gray-300 pt-4">
                <tr class="">
                    <th class="">Mã phiếu</th>
                    <th class="">Bãi xe trực thuộc</th>
                    <th class="">Hành động</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-gray-300">
                {% for phieu in danhsachphieu %}
                    <tr class="hover:bg-slate-100">
                        <td>{{ phieu.Phieu }}</td>
                        <td>{{ phieu.Mabai }}</td>
                        <td class="inline-flex rounded-md shadow-sm divide-x-2">
                            <a href="{{ req.baseUrl }}/detail/{{ phieu.Phieu }}" class="bg-white px-4 py-2 hover:bg-gray-200 rounded-l-lg">Xem chi tiết</a>
                            <a href="{{ req.baseUrl }}/detail/{{ phieu.Phieu }}" class="bg-white px-4 py-2 hover:bg-gray-200">Sửa</a>
                            <button onclick="promptDelete('{{ req.baseUrl }}/detail/{{ phieu.Phieu }}/delete', '{{ phieu.Phieu }}. {{ phieu.Mabai }}')" class="bg-white px-4 py-2 hover:bg-gray-200 rounded-r-lg">Xoá</button>
                        </td>
                    </tr>
                {% else %}
                    <tr class="bg-slate-100">
                        <td colspan="6">{{ "Không tìm thấy phiếu xe nào." }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <div class="hidden transition-all fixed w-screen h-screen top-0 bg-red-700 bg-opacity-80 flex justify-center" id="delete-prompt">
        <div class="p-4 max-w-2xl fixed top-1/2 -translate-y-1/2 w-full">
            <div class="text-white text-4xl text-center mb-4">KHOANNNNN</div>
            <div class="text-white text-center">Xác nhận xoá</div>
            <div class="text-white text-center" id="delete-prompt-name"></div>
            <div class="text-white text-center mb-4">Thao tác này sẽ không thể hoàn tác.</div>
            <form
                action=""
                method="post"
                id="delete-form">
                <button type="submit" class="bg-white text-red-700 w-full py-2 mb-4">Chắc chắn</button>
            </form>
            <button onclick="deletePrompt.classList.add('hidden')" class="text-white border-white border-solid border w-full py-2">Huỷ thao tác xoá, trở về</button>
        </div>
        <script>
            const deletePrompt = document.getElementById("delete-prompt")
            const promptName = document.getElementById("delete-prompt-name")
            const deleteForm = document.getElementById("delete-form")
            function promptDelete(url, name) {
                promptName.textContent = name;
                deleteForm.action = url
                deletePrompt.classList.remove("hidden");
            }
        </script>
{% endblock %}